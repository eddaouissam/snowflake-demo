
  
    

        create or replace transient table DEV_DB.DBT_VAULT.sat_location
         as
        (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.LOCATION_HK, a.LOCATION_HASHDIFF, a.LOCATION_CODE, a.LOCATION_PLANNING_CODE, a.CANCELLED_FLAG, a.DUMMY_FLAG, a.STORE_GROUP_CODE, a.CURRENCY_ID, a.CONCEPT_CODE, a.SELL_SQUARE_FEET, a.SELL_MQ, a.NOSELL_SQUARE_FEET, a.NOSELL_MQ, a.GROSS_STORE_SIZE, a.SDB_CHANNEL_CODE, a.LOCATION_SUBSUBTYPE_ID, a.LOCATION_SUBSUBTYPE_CODE, a.LOCATION_SUBSUBTYPE_TYPOLOGY, a.LOCATION_SUBTYPE_ID, a.LOCATION_SUBTYPE_CODE, a.LOCATION_SUBTYPE_CODE_TYPOLOGY, a.LOCATION_TYPE_ID, a.LOCATION_TYPE_CODE, a.LOCATION_TYPE_CODE_TYPOLOGY, a.DISTRIBUTION_CHANNEL_ID, a.DISTRIBUTION_CHANNEL_CODE, a.DISTRIBUTION_CHANNEL_TYPOLOGY, a.CITY_ID, a.CITY_CODE, a.STATE_ID, a.STATE_CODE, a.COUNTRY_ID, a.COUNTRY_CODE, a.DISTRICT_ID, a.DISTRICT_CODE, a.ZONE_ID, a.ZONE_CODE, a.REGION_ID, a.REGION_CODE, a.AREA_ID, a.AREA_CODE, a.MACROAREA_ID, a.MACROAREA_CODE, a.LOCATION_STATUS_ID, a.LOCATION_STATUS_CODE, a.REPORTING_UNIT_ID, a.REPORTING_UNIT_CODE, a.MACROZONE_ID, a.MACROZONE_CODE, a.CHANNEL_ID, a.CHANNEL_CODE, a.STORE_GROUP_PLAN_ID, a.STORE_GROUP_PLAN_CODE, a.STORE_GROUP_PLAN_TYPOLOGY, a.CHANNEL_PLAN_ID, a.CHANNEL_PLAN_CODE, a.CHANNEL_PLAN_TYPOLOGY, a.COUNTRY_PLAN_ID, a.COUNTRY_PLAN_CODE, a.LOCATION_OPENING_DATE, a.LOCATION_CLOSURE_DATE, a.CONSOLIDATED_FLAG_ID, a.CONSOLIDATED_FLAG_CODE, a.TIER_CITY_ID, a.TIER_CITY_CODE, a.CHANNEL_PLAN_SORT, a.OPERATION_FLAG, a.INSERT_DATE, a.UPDATE_DATE, a.__DELETE_FLAG, a.__DQ_FLAG, a.__DUMMY_FLAG, a.DATE_PARTITION, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DEV_DB.DBT_VAULT.v_stg_location AS a
    WHERE a.LOCATION_HK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LOCATION_HK, stage.LOCATION_HASHDIFF, stage.LOCATION_CODE, stage.LOCATION_PLANNING_CODE, stage.CANCELLED_FLAG, stage.DUMMY_FLAG, stage.STORE_GROUP_CODE, stage.CURRENCY_ID, stage.CONCEPT_CODE, stage.SELL_SQUARE_FEET, stage.SELL_MQ, stage.NOSELL_SQUARE_FEET, stage.NOSELL_MQ, stage.GROSS_STORE_SIZE, stage.SDB_CHANNEL_CODE, stage.LOCATION_SUBSUBTYPE_ID, stage.LOCATION_SUBSUBTYPE_CODE, stage.LOCATION_SUBSUBTYPE_TYPOLOGY, stage.LOCATION_SUBTYPE_ID, stage.LOCATION_SUBTYPE_CODE, stage.LOCATION_SUBTYPE_CODE_TYPOLOGY, stage.LOCATION_TYPE_ID, stage.LOCATION_TYPE_CODE, stage.LOCATION_TYPE_CODE_TYPOLOGY, stage.DISTRIBUTION_CHANNEL_ID, stage.DISTRIBUTION_CHANNEL_CODE, stage.DISTRIBUTION_CHANNEL_TYPOLOGY, stage.CITY_ID, stage.CITY_CODE, stage.STATE_ID, stage.STATE_CODE, stage.COUNTRY_ID, stage.COUNTRY_CODE, stage.DISTRICT_ID, stage.DISTRICT_CODE, stage.ZONE_ID, stage.ZONE_CODE, stage.REGION_ID, stage.REGION_CODE, stage.AREA_ID, stage.AREA_CODE, stage.MACROAREA_ID, stage.MACROAREA_CODE, stage.LOCATION_STATUS_ID, stage.LOCATION_STATUS_CODE, stage.REPORTING_UNIT_ID, stage.REPORTING_UNIT_CODE, stage.MACROZONE_ID, stage.MACROZONE_CODE, stage.CHANNEL_ID, stage.CHANNEL_CODE, stage.STORE_GROUP_PLAN_ID, stage.STORE_GROUP_PLAN_CODE, stage.STORE_GROUP_PLAN_TYPOLOGY, stage.CHANNEL_PLAN_ID, stage.CHANNEL_PLAN_CODE, stage.CHANNEL_PLAN_TYPOLOGY, stage.COUNTRY_PLAN_ID, stage.COUNTRY_PLAN_CODE, stage.LOCATION_OPENING_DATE, stage.LOCATION_CLOSURE_DATE, stage.CONSOLIDATED_FLAG_ID, stage.CONSOLIDATED_FLAG_CODE, stage.TIER_CITY_ID, stage.TIER_CITY_CODE, stage.CHANNEL_PLAN_SORT, stage.OPERATION_FLAG, stage.INSERT_DATE, stage.UPDATE_DATE, stage.__DELETE_FLAG, stage.__DQ_FLAG, stage.__DUMMY_FLAG, stage.DATE_PARTITION, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
      
  
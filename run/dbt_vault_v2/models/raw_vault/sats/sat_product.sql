
  
    

        create or replace transient table DEV_DB.DBT_VAULT.sat_product
         as
        (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.PRODUCT_HK, a.PRODUCT_HASHDIFF, a.SIZE_CODE_REF, a.SIZE_CODE_DESC, a.SELLING_FLAG, a.STYLE_COLOR_ID, a.STYLE_COLOR_CODE, a.STYLE_COLOR_ORIGINAL_CODE, a.STYLE_COLOR_RENAMED_CODE, a.STYLE_COLOR_BORN_SEA_EVENT_ID, a.STYLE_COLOR_BORN_SEA_YEAR_ID, a.STYLE_COLOR_BORN_SEA_YEAR_CODE, a.STYLE_COLOR_BORN_EVENT_CODE, a.STYLE_COLOR_END_SEA_EVENT_ID, a.STYLE_COLOR_END_SEA_YEAR_ID, a.STYLE_COLOR_END_SEA_YEAR_CODE, a.STYLE_COLOR_END_EVENT_CODE, a.STYLE_ID, a.STYLE_CODE, a.MODEL_ID, a.MODEL_CODE, a.MODEL_BORN_SEASON_ID, a.MODEL_BORN_SEASON_YEAR_CODE, a.MATERIAL_ID, a.MATERIAL_CODE, a.MATERIAL_TRIM_TYPE_ID, a.MATERIAL_TRIM_TYPE_CODE, a.COLOR_ID, a.COLOR_CODE, a.COLOR_SUBFAMILY_ID, a.COLOR_SUBFAMILY_CODE, a.COLOR_FAMILY_ID, a.COLOR_FAMILY_CODE, a.SUBCLASS_ID, a.SUBCLASS_CODE, a.SUBCLASS_SHORT_CODE, a.SUBCLASS_GROUP_ID, a.SUBCLASS_GROUP_CODE, a.CLASS_GROUP_02_ID, a.CLASS_GROUP_02_CODE, a.CLASS_ID, a.CLASS_CODE, a.CLASS_SHORT_CODE, a.CLASS_GROUP_01_ID, a.CLASS_GROUP_01_CODE, a.SUBDEPARTMENT_ID, a.SUBDEPARTMENT_SHORT_CODE, a.SUBDEPARTMENT_TYPE_ID, a.SUBDEPARTMENT_TYPE_CODE, a.MERCHANDISE_DEPARTMENT_ID, a.MERCHANDISE_DEPARTMENT_CODE, a.MERCHANDISE_DEPT_GROUP_ID, a.MERCHANDISE_DEPT_GROUP_CODE, a.MACRO_DEPARTMENT_GROUP_ID, a.MACRO_DEPARTMENT_GROUP_CODE, a.CATEGORY_GROUP_ID, a.CATEGORY_GROUP_CODE, a.DEPARTMENT_ID, a.DEPARTMENT_CODE, a.DEPARTMENT_GROUP_ID, a.DEPARTMENT_GROUP_CODE, a.LINE_ID, a.LINE_CODE, a.LINE_GROUP_ID, a.LINE_GROUP_CODE, a.FUNCTION_ID, a.FUNCTION_CODE, a.TENTATIVE_MD_ID, a.TENTATIVE_MD_CODE, a.COLOR_GROUP_ID, a.COLOR_GROUP_CODE, a.SOLD_FLAG, a.PREV_STATUS_ID, a.PREV_STATUS_CODE, a.PREV_STATUS_SEASON_YEAR_ID, a.PREV_STATUS_SEASON_YEAR_CODE, a.PREV_STATUS_EVENT_ID, a.PREV_STATUS_EVENT_CODE, a.CURR_STATUS_ID, a.CURR_STATUS_CODE, a.CURR_STATUS_SEASON_YEAR_ID, a.CURR_STATUS_SEASON_YEAR_CODE, a.CURR_STATUS_EVENT_ID, a.CURR_STATUS_EVENT_CODE, a.NEXT_STATUS_ID, a.NEXT_STATUS_CODE, a.NEXT_STATUS_SEASON_YEAR_ID, a.NEXT_STATUS_SEASON_YEAR_CODE, a.NEXT_STATUS_EVENT_ID, a.NEXT_STATUS_EVENT_CODE, a.OPERATION_FLAG, a.INSERT_DATE, a.UPDATE_DATE, a.__DELETE_FLAG, a.__DUMMY_FLAG, a.__DQ_FLAG, a.DATE_PARTITION, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DEV_DB.DBT_VAULT.v_stg_product AS a
    WHERE a.PRODUCT_HK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PRODUCT_HK, stage.PRODUCT_HASHDIFF, stage.SIZE_CODE_REF, stage.SIZE_CODE_DESC, stage.SELLING_FLAG, stage.STYLE_COLOR_ID, stage.STYLE_COLOR_CODE, stage.STYLE_COLOR_ORIGINAL_CODE, stage.STYLE_COLOR_RENAMED_CODE, stage.STYLE_COLOR_BORN_SEA_EVENT_ID, stage.STYLE_COLOR_BORN_SEA_YEAR_ID, stage.STYLE_COLOR_BORN_SEA_YEAR_CODE, stage.STYLE_COLOR_BORN_EVENT_CODE, stage.STYLE_COLOR_END_SEA_EVENT_ID, stage.STYLE_COLOR_END_SEA_YEAR_ID, stage.STYLE_COLOR_END_SEA_YEAR_CODE, stage.STYLE_COLOR_END_EVENT_CODE, stage.STYLE_ID, stage.STYLE_CODE, stage.MODEL_ID, stage.MODEL_CODE, stage.MODEL_BORN_SEASON_ID, stage.MODEL_BORN_SEASON_YEAR_CODE, stage.MATERIAL_ID, stage.MATERIAL_CODE, stage.MATERIAL_TRIM_TYPE_ID, stage.MATERIAL_TRIM_TYPE_CODE, stage.COLOR_ID, stage.COLOR_CODE, stage.COLOR_SUBFAMILY_ID, stage.COLOR_SUBFAMILY_CODE, stage.COLOR_FAMILY_ID, stage.COLOR_FAMILY_CODE, stage.SUBCLASS_ID, stage.SUBCLASS_CODE, stage.SUBCLASS_SHORT_CODE, stage.SUBCLASS_GROUP_ID, stage.SUBCLASS_GROUP_CODE, stage.CLASS_GROUP_02_ID, stage.CLASS_GROUP_02_CODE, stage.CLASS_ID, stage.CLASS_CODE, stage.CLASS_SHORT_CODE, stage.CLASS_GROUP_01_ID, stage.CLASS_GROUP_01_CODE, stage.SUBDEPARTMENT_ID, stage.SUBDEPARTMENT_SHORT_CODE, stage.SUBDEPARTMENT_TYPE_ID, stage.SUBDEPARTMENT_TYPE_CODE, stage.MERCHANDISE_DEPARTMENT_ID, stage.MERCHANDISE_DEPARTMENT_CODE, stage.MERCHANDISE_DEPT_GROUP_ID, stage.MERCHANDISE_DEPT_GROUP_CODE, stage.MACRO_DEPARTMENT_GROUP_ID, stage.MACRO_DEPARTMENT_GROUP_CODE, stage.CATEGORY_GROUP_ID, stage.CATEGORY_GROUP_CODE, stage.DEPARTMENT_ID, stage.DEPARTMENT_CODE, stage.DEPARTMENT_GROUP_ID, stage.DEPARTMENT_GROUP_CODE, stage.LINE_ID, stage.LINE_CODE, stage.LINE_GROUP_ID, stage.LINE_GROUP_CODE, stage.FUNCTION_ID, stage.FUNCTION_CODE, stage.TENTATIVE_MD_ID, stage.TENTATIVE_MD_CODE, stage.COLOR_GROUP_ID, stage.COLOR_GROUP_CODE, stage.SOLD_FLAG, stage.PREV_STATUS_ID, stage.PREV_STATUS_CODE, stage.PREV_STATUS_SEASON_YEAR_ID, stage.PREV_STATUS_SEASON_YEAR_CODE, stage.PREV_STATUS_EVENT_ID, stage.PREV_STATUS_EVENT_CODE, stage.CURR_STATUS_ID, stage.CURR_STATUS_CODE, stage.CURR_STATUS_SEASON_YEAR_ID, stage.CURR_STATUS_SEASON_YEAR_CODE, stage.CURR_STATUS_EVENT_ID, stage.CURR_STATUS_EVENT_CODE, stage.NEXT_STATUS_ID, stage.NEXT_STATUS_CODE, stage.NEXT_STATUS_SEASON_YEAR_ID, stage.NEXT_STATUS_SEASON_YEAR_CODE, stage.NEXT_STATUS_EVENT_ID, stage.NEXT_STATUS_EVENT_CODE, stage.OPERATION_FLAG, stage.INSERT_DATE, stage.UPDATE_DATE, stage.__DELETE_FLAG, stage.__DUMMY_FLAG, stage.__DQ_FLAG, stage.DATE_PARTITION, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
      
  
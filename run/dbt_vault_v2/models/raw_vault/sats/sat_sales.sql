
  
    

        create or replace transient table DEV_DB.DBT_VAULT.sat_sales
         as
        (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SALES_HK, a.SALES_HASHDIFF, a.PARTITION_KEY, a.SUBPARTITION_KEY, a.TICKET_CODE, a.TICKET_LINE_CODE, a.LOCATION_ORIGINAL_ID, a.BUSINESS_DATE, a.REGISTER_CODE, a.TRANSACTION_TIME, a.TRANSACTION_TYPE_ID, a.TRANSACTION_TYPE_CODE, a.SALE_ASSISTANT_ID, a.SALE_ASSISTANT_CODE, a.CUSTOMER_CODE, a.QTY, a.AMT_DISCOUNTED, a.AMT_DISCOUNTED_TAXED, a.AMT_TAX, a.AMT_DISCOUNT, a.AMT_DISCOUNT_TAXED, a.CURRENCY_ID, a.CLIENTELE_AREA_STATE_ID, a.CLIENTELE_AREA_REGIONAL_ID, a.CLIENTELE_AREA_WW_ID, a.MARK_DOWN_ID, a.LOCAL_MARK_DOWN_ID, a.SALE_MARK_DOWN_ID, a.TYPOLOGY_ID, a.TYPOLOGY_CODE, a.TICKET_LINE_TYPE, a.AUDIT_TYPE_ID, a.AUDIT_TYPE_CODE, a.TAG_SOURCE_CODE, a.OPERATION_FLAG, a.INSERT_DATE, a.UPDATE_DATE, a.__INSERT_TSTAMP, a.__UPDATE_TSTAMP, a.__DELETE_FLAG, a.DATE_PARTITION, a.LOAD_DATE, a.RECORD_SOURCE
    FROM DEV_DB.DBT_VAULT.v_stg_sales AS a
    WHERE a.SALES_HK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SALES_HK, stage.SALES_HASHDIFF, stage.PARTITION_KEY, stage.SUBPARTITION_KEY, stage.TICKET_CODE, stage.TICKET_LINE_CODE, stage.LOCATION_ORIGINAL_ID, stage.BUSINESS_DATE, stage.REGISTER_CODE, stage.TRANSACTION_TIME, stage.TRANSACTION_TYPE_ID, stage.TRANSACTION_TYPE_CODE, stage.SALE_ASSISTANT_ID, stage.SALE_ASSISTANT_CODE, stage.CUSTOMER_CODE, stage.QTY, stage.AMT_DISCOUNTED, stage.AMT_DISCOUNTED_TAXED, stage.AMT_TAX, stage.AMT_DISCOUNT, stage.AMT_DISCOUNT_TAXED, stage.CURRENCY_ID, stage.CLIENTELE_AREA_STATE_ID, stage.CLIENTELE_AREA_REGIONAL_ID, stage.CLIENTELE_AREA_WW_ID, stage.MARK_DOWN_ID, stage.LOCAL_MARK_DOWN_ID, stage.SALE_MARK_DOWN_ID, stage.TYPOLOGY_ID, stage.TYPOLOGY_CODE, stage.TICKET_LINE_TYPE, stage.AUDIT_TYPE_ID, stage.AUDIT_TYPE_CODE, stage.TAG_SOURCE_CODE, stage.OPERATION_FLAG, stage.INSERT_DATE, stage.UPDATE_DATE, stage.__INSERT_TSTAMP, stage.__UPDATE_TSTAMP, stage.__DELETE_FLAG, stage.DATE_PARTITION, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
        );
      
  

  create or replace   view DEV_DB.DBT_VAULT.v_stg_product
  
   as (
    














-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    SKU_ID,
    SIZE_CODE_REF,
    SIZE_CODE_DESC,
    SELLING_FLAG,
    STYLE_COLOR_ID,
    STYLE_COLOR_CODE,
    STYLE_COLOR_ORIGINAL_CODE,
    STYLE_COLOR_RENAMED_CODE,
    STYLE_COLOR_BORN_SEA_EVENT_ID,
    STYLE_COLOR_BORN_SEA_YEAR_ID,
    STYLE_COLOR_BORN_SEA_YEAR_CODE,
    STYLE_COLOR_BORN_EVENT_CODE,
    STYLE_COLOR_END_SEA_EVENT_ID,
    STYLE_COLOR_END_SEA_YEAR_ID,
    STYLE_COLOR_END_SEA_YEAR_CODE,
    STYLE_COLOR_END_EVENT_CODE,
    STYLE_ID,
    STYLE_CODE,
    MODEL_ID,
    MODEL_CODE,
    MODEL_BORN_SEASON_ID,
    MODEL_BORN_SEASON_YEAR_CODE,
    MATERIAL_ID,
    MATERIAL_CODE,
    MATERIAL_TRIM_TYPE_ID,
    MATERIAL_TRIM_TYPE_CODE,
    COLOR_ID,
    COLOR_CODE,
    COLOR_SUBFAMILY_ID,
    COLOR_SUBFAMILY_CODE,
    COLOR_FAMILY_ID,
    COLOR_FAMILY_CODE,
    SUBCLASS_ID,
    SUBCLASS_CODE,
    SUBCLASS_SHORT_CODE,
    SUBCLASS_GROUP_ID,
    SUBCLASS_GROUP_CODE,
    CLASS_GROUP_02_ID,
    CLASS_GROUP_02_CODE,
    CLASS_ID,
    CLASS_CODE,
    CLASS_SHORT_CODE,
    CLASS_GROUP_01_ID,
    CLASS_GROUP_01_CODE,
    SUBDEPARTMENT_ID,
    SUBDEPARTMENT_SHORT_CODE,
    SUBDEPARTMENT_TYPE_ID,
    SUBDEPARTMENT_TYPE_CODE,
    MERCHANDISE_DEPARTMENT_ID,
    MERCHANDISE_DEPARTMENT_CODE,
    MERCHANDISE_DEPT_GROUP_ID,
    MERCHANDISE_DEPT_GROUP_CODE,
    MACRO_DEPARTMENT_GROUP_ID,
    MACRO_DEPARTMENT_GROUP_CODE,
    CATEGORY_GROUP_ID,
    CATEGORY_GROUP_CODE,
    DEPARTMENT_ID,
    DEPARTMENT_CODE,
    DEPARTMENT_GROUP_ID,
    DEPARTMENT_GROUP_CODE,
    LINE_ID,
    LINE_CODE,
    LINE_GROUP_ID,
    LINE_GROUP_CODE,
    FUNCTION_ID,
    FUNCTION_CODE,
    TENTATIVE_MD_ID,
    TENTATIVE_MD_CODE,
    COLOR_GROUP_ID,
    COLOR_GROUP_CODE,
    SOLD_FLAG,
    PREV_STATUS_ID,
    PREV_STATUS_CODE,
    PREV_STATUS_SEASON_YEAR_ID,
    PREV_STATUS_SEASON_YEAR_CODE,
    PREV_STATUS_EVENT_ID,
    PREV_STATUS_EVENT_CODE,
    CURR_STATUS_ID,
    CURR_STATUS_CODE,
    CURR_STATUS_SEASON_YEAR_ID,
    CURR_STATUS_SEASON_YEAR_CODE,
    CURR_STATUS_EVENT_ID,
    CURR_STATUS_EVENT_CODE,
    NEXT_STATUS_ID,
    NEXT_STATUS_CODE,
    NEXT_STATUS_SEASON_YEAR_ID,
    NEXT_STATUS_SEASON_YEAR_CODE,
    NEXT_STATUS_EVENT_ID,
    NEXT_STATUS_EVENT_CODE,
    OPERATION_FLAG,
    INSERT_DATE,
    UPDATE_DATE,
    __DELETE_FLAG,
    __DUMMY_FLAG,
    __DQ_FLAG,
    DATE_PARTITION,
    LDTS,
    SOURCE_FILE

    FROM DEV_DB.DBT_VAULT.raw_product
),

derived_columns AS (

    SELECT

    SKU_ID,
    SIZE_CODE_REF,
    SIZE_CODE_DESC,
    SELLING_FLAG,
    STYLE_COLOR_ID,
    STYLE_COLOR_CODE,
    STYLE_COLOR_ORIGINAL_CODE,
    STYLE_COLOR_RENAMED_CODE,
    STYLE_COLOR_BORN_SEA_EVENT_ID,
    STYLE_COLOR_BORN_SEA_YEAR_ID,
    STYLE_COLOR_BORN_SEA_YEAR_CODE,
    STYLE_COLOR_BORN_EVENT_CODE,
    STYLE_COLOR_END_SEA_EVENT_ID,
    STYLE_COLOR_END_SEA_YEAR_ID,
    STYLE_COLOR_END_SEA_YEAR_CODE,
    STYLE_COLOR_END_EVENT_CODE,
    STYLE_ID,
    STYLE_CODE,
    MODEL_ID,
    MODEL_CODE,
    MODEL_BORN_SEASON_ID,
    MODEL_BORN_SEASON_YEAR_CODE,
    MATERIAL_ID,
    MATERIAL_CODE,
    MATERIAL_TRIM_TYPE_ID,
    MATERIAL_TRIM_TYPE_CODE,
    COLOR_ID,
    COLOR_CODE,
    COLOR_SUBFAMILY_ID,
    COLOR_SUBFAMILY_CODE,
    COLOR_FAMILY_ID,
    COLOR_FAMILY_CODE,
    SUBCLASS_ID,
    SUBCLASS_CODE,
    SUBCLASS_SHORT_CODE,
    SUBCLASS_GROUP_ID,
    SUBCLASS_GROUP_CODE,
    CLASS_GROUP_02_ID,
    CLASS_GROUP_02_CODE,
    CLASS_ID,
    CLASS_CODE,
    CLASS_SHORT_CODE,
    CLASS_GROUP_01_ID,
    CLASS_GROUP_01_CODE,
    SUBDEPARTMENT_ID,
    SUBDEPARTMENT_SHORT_CODE,
    SUBDEPARTMENT_TYPE_ID,
    SUBDEPARTMENT_TYPE_CODE,
    MERCHANDISE_DEPARTMENT_ID,
    MERCHANDISE_DEPARTMENT_CODE,
    MERCHANDISE_DEPT_GROUP_ID,
    MERCHANDISE_DEPT_GROUP_CODE,
    MACRO_DEPARTMENT_GROUP_ID,
    MACRO_DEPARTMENT_GROUP_CODE,
    CATEGORY_GROUP_ID,
    CATEGORY_GROUP_CODE,
    DEPARTMENT_ID,
    DEPARTMENT_CODE,
    DEPARTMENT_GROUP_ID,
    DEPARTMENT_GROUP_CODE,
    LINE_ID,
    LINE_CODE,
    LINE_GROUP_ID,
    LINE_GROUP_CODE,
    FUNCTION_ID,
    FUNCTION_CODE,
    TENTATIVE_MD_ID,
    TENTATIVE_MD_CODE,
    COLOR_GROUP_ID,
    COLOR_GROUP_CODE,
    SOLD_FLAG,
    PREV_STATUS_ID,
    PREV_STATUS_CODE,
    PREV_STATUS_SEASON_YEAR_ID,
    PREV_STATUS_SEASON_YEAR_CODE,
    PREV_STATUS_EVENT_ID,
    PREV_STATUS_EVENT_CODE,
    CURR_STATUS_ID,
    CURR_STATUS_CODE,
    CURR_STATUS_SEASON_YEAR_ID,
    CURR_STATUS_SEASON_YEAR_CODE,
    CURR_STATUS_EVENT_ID,
    CURR_STATUS_EVENT_CODE,
    NEXT_STATUS_ID,
    NEXT_STATUS_CODE,
    NEXT_STATUS_SEASON_YEAR_ID,
    NEXT_STATUS_SEASON_YEAR_CODE,
    NEXT_STATUS_EVENT_ID,
    NEXT_STATUS_EVENT_CODE,
    OPERATION_FLAG,
    INSERT_DATE,
    UPDATE_DATE,
    __DELETE_FLAG,
    __DUMMY_FLAG,
    __DQ_FLAG,
    DATE_PARTITION,
    LDTS,
    SOURCE_FILE,
    SOURCE_FILE AS RECORD_SOURCE,
    SKU_ID AS PRODUCT_KEY,
    LDTS AS LOAD_DATE

    FROM source_data
),

hashed_columns AS (

    SELECT

    SKU_ID,
    SIZE_CODE_REF,
    SIZE_CODE_DESC,
    SELLING_FLAG,
    STYLE_COLOR_ID,
    STYLE_COLOR_CODE,
    STYLE_COLOR_ORIGINAL_CODE,
    STYLE_COLOR_RENAMED_CODE,
    STYLE_COLOR_BORN_SEA_EVENT_ID,
    STYLE_COLOR_BORN_SEA_YEAR_ID,
    STYLE_COLOR_BORN_SEA_YEAR_CODE,
    STYLE_COLOR_BORN_EVENT_CODE,
    STYLE_COLOR_END_SEA_EVENT_ID,
    STYLE_COLOR_END_SEA_YEAR_ID,
    STYLE_COLOR_END_SEA_YEAR_CODE,
    STYLE_COLOR_END_EVENT_CODE,
    STYLE_ID,
    STYLE_CODE,
    MODEL_ID,
    MODEL_CODE,
    MODEL_BORN_SEASON_ID,
    MODEL_BORN_SEASON_YEAR_CODE,
    MATERIAL_ID,
    MATERIAL_CODE,
    MATERIAL_TRIM_TYPE_ID,
    MATERIAL_TRIM_TYPE_CODE,
    COLOR_ID,
    COLOR_CODE,
    COLOR_SUBFAMILY_ID,
    COLOR_SUBFAMILY_CODE,
    COLOR_FAMILY_ID,
    COLOR_FAMILY_CODE,
    SUBCLASS_ID,
    SUBCLASS_CODE,
    SUBCLASS_SHORT_CODE,
    SUBCLASS_GROUP_ID,
    SUBCLASS_GROUP_CODE,
    CLASS_GROUP_02_ID,
    CLASS_GROUP_02_CODE,
    CLASS_ID,
    CLASS_CODE,
    CLASS_SHORT_CODE,
    CLASS_GROUP_01_ID,
    CLASS_GROUP_01_CODE,
    SUBDEPARTMENT_ID,
    SUBDEPARTMENT_SHORT_CODE,
    SUBDEPARTMENT_TYPE_ID,
    SUBDEPARTMENT_TYPE_CODE,
    MERCHANDISE_DEPARTMENT_ID,
    MERCHANDISE_DEPARTMENT_CODE,
    MERCHANDISE_DEPT_GROUP_ID,
    MERCHANDISE_DEPT_GROUP_CODE,
    MACRO_DEPARTMENT_GROUP_ID,
    MACRO_DEPARTMENT_GROUP_CODE,
    CATEGORY_GROUP_ID,
    CATEGORY_GROUP_CODE,
    DEPARTMENT_ID,
    DEPARTMENT_CODE,
    DEPARTMENT_GROUP_ID,
    DEPARTMENT_GROUP_CODE,
    LINE_ID,
    LINE_CODE,
    LINE_GROUP_ID,
    LINE_GROUP_CODE,
    FUNCTION_ID,
    FUNCTION_CODE,
    TENTATIVE_MD_ID,
    TENTATIVE_MD_CODE,
    COLOR_GROUP_ID,
    COLOR_GROUP_CODE,
    SOLD_FLAG,
    PREV_STATUS_ID,
    PREV_STATUS_CODE,
    PREV_STATUS_SEASON_YEAR_ID,
    PREV_STATUS_SEASON_YEAR_CODE,
    PREV_STATUS_EVENT_ID,
    PREV_STATUS_EVENT_CODE,
    CURR_STATUS_ID,
    CURR_STATUS_CODE,
    CURR_STATUS_SEASON_YEAR_ID,
    CURR_STATUS_SEASON_YEAR_CODE,
    CURR_STATUS_EVENT_ID,
    CURR_STATUS_EVENT_CODE,
    NEXT_STATUS_ID,
    NEXT_STATUS_CODE,
    NEXT_STATUS_SEASON_YEAR_ID,
    NEXT_STATUS_SEASON_YEAR_CODE,
    NEXT_STATUS_EVENT_ID,
    NEXT_STATUS_EVENT_CODE,
    OPERATION_FLAG,
    INSERT_DATE,
    UPDATE_DATE,
    __DELETE_FLAG,
    __DUMMY_FLAG,
    __DQ_FLAG,
    DATE_PARTITION,
    LDTS,
    SOURCE_FILE,
    RECORD_SOURCE,
    PRODUCT_KEY,
    LOAD_DATE,

    CAST(MD5_BINARY(NULLIF(UPPER(TRIM(CAST(SKU_ID AS VARCHAR))), '')) AS BINARY(16)) AS PRODUCT_HK,

    CAST(MD5_BINARY(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(__DELETE_FLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(__DQ_FLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(__DUMMY_FLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CATEGORY_GROUP_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CATEGORY_GROUP_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLASS_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLASS_GROUP_01_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLASS_GROUP_01_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLASS_GROUP_02_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLASS_GROUP_02_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLASS_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLASS_SHORT_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COLOR_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COLOR_FAMILY_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COLOR_FAMILY_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COLOR_GROUP_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COLOR_GROUP_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COLOR_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COLOR_SUBFAMILY_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(COLOR_SUBFAMILY_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CURR_STATUS_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CURR_STATUS_EVENT_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CURR_STATUS_EVENT_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CURR_STATUS_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CURR_STATUS_SEASON_YEAR_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CURR_STATUS_SEASON_YEAR_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DATE_PARTITION AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DEPARTMENT_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DEPARTMENT_GROUP_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DEPARTMENT_GROUP_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DEPARTMENT_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(FUNCTION_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(FUNCTION_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(INSERT_DATE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_GROUP_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_GROUP_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MACRO_DEPARTMENT_GROUP_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MACRO_DEPARTMENT_GROUP_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MATERIAL_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MATERIAL_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MATERIAL_TRIM_TYPE_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MATERIAL_TRIM_TYPE_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MERCHANDISE_DEPARTMENT_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MERCHANDISE_DEPARTMENT_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MERCHANDISE_DEPT_GROUP_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MERCHANDISE_DEPT_GROUP_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MODEL_BORN_SEASON_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MODEL_BORN_SEASON_YEAR_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MODEL_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(MODEL_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(NEXT_STATUS_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(NEXT_STATUS_EVENT_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(NEXT_STATUS_EVENT_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(NEXT_STATUS_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(NEXT_STATUS_SEASON_YEAR_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(NEXT_STATUS_SEASON_YEAR_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(OPERATION_FLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PREV_STATUS_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PREV_STATUS_EVENT_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PREV_STATUS_EVENT_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PREV_STATUS_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PREV_STATUS_SEASON_YEAR_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PREV_STATUS_SEASON_YEAR_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SELLING_FLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SIZE_CODE_DESC AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SIZE_CODE_REF AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SOLD_FLAG AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_BORN_EVENT_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_BORN_SEA_EVENT_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_BORN_SEA_YEAR_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_BORN_SEA_YEAR_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_END_EVENT_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_END_SEA_EVENT_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_END_SEA_YEAR_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_END_SEA_YEAR_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_ORIGINAL_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_COLOR_RENAMED_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(STYLE_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUBCLASS_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUBCLASS_GROUP_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUBCLASS_GROUP_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUBCLASS_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUBCLASS_SHORT_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUBDEPARTMENT_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUBDEPARTMENT_SHORT_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUBDEPARTMENT_TYPE_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUBDEPARTMENT_TYPE_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TENTATIVE_MD_CODE AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TENTATIVE_MD_ID AS VARCHAR))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(UPDATE_DATE AS VARCHAR))), ''), '^^')
    )) AS BINARY(16)) AS PRODUCT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    SKU_ID,
    SIZE_CODE_REF,
    SIZE_CODE_DESC,
    SELLING_FLAG,
    STYLE_COLOR_ID,
    STYLE_COLOR_CODE,
    STYLE_COLOR_ORIGINAL_CODE,
    STYLE_COLOR_RENAMED_CODE,
    STYLE_COLOR_BORN_SEA_EVENT_ID,
    STYLE_COLOR_BORN_SEA_YEAR_ID,
    STYLE_COLOR_BORN_SEA_YEAR_CODE,
    STYLE_COLOR_BORN_EVENT_CODE,
    STYLE_COLOR_END_SEA_EVENT_ID,
    STYLE_COLOR_END_SEA_YEAR_ID,
    STYLE_COLOR_END_SEA_YEAR_CODE,
    STYLE_COLOR_END_EVENT_CODE,
    STYLE_ID,
    STYLE_CODE,
    MODEL_ID,
    MODEL_CODE,
    MODEL_BORN_SEASON_ID,
    MODEL_BORN_SEASON_YEAR_CODE,
    MATERIAL_ID,
    MATERIAL_CODE,
    MATERIAL_TRIM_TYPE_ID,
    MATERIAL_TRIM_TYPE_CODE,
    COLOR_ID,
    COLOR_CODE,
    COLOR_SUBFAMILY_ID,
    COLOR_SUBFAMILY_CODE,
    COLOR_FAMILY_ID,
    COLOR_FAMILY_CODE,
    SUBCLASS_ID,
    SUBCLASS_CODE,
    SUBCLASS_SHORT_CODE,
    SUBCLASS_GROUP_ID,
    SUBCLASS_GROUP_CODE,
    CLASS_GROUP_02_ID,
    CLASS_GROUP_02_CODE,
    CLASS_ID,
    CLASS_CODE,
    CLASS_SHORT_CODE,
    CLASS_GROUP_01_ID,
    CLASS_GROUP_01_CODE,
    SUBDEPARTMENT_ID,
    SUBDEPARTMENT_SHORT_CODE,
    SUBDEPARTMENT_TYPE_ID,
    SUBDEPARTMENT_TYPE_CODE,
    MERCHANDISE_DEPARTMENT_ID,
    MERCHANDISE_DEPARTMENT_CODE,
    MERCHANDISE_DEPT_GROUP_ID,
    MERCHANDISE_DEPT_GROUP_CODE,
    MACRO_DEPARTMENT_GROUP_ID,
    MACRO_DEPARTMENT_GROUP_CODE,
    CATEGORY_GROUP_ID,
    CATEGORY_GROUP_CODE,
    DEPARTMENT_ID,
    DEPARTMENT_CODE,
    DEPARTMENT_GROUP_ID,
    DEPARTMENT_GROUP_CODE,
    LINE_ID,
    LINE_CODE,
    LINE_GROUP_ID,
    LINE_GROUP_CODE,
    FUNCTION_ID,
    FUNCTION_CODE,
    TENTATIVE_MD_ID,
    TENTATIVE_MD_CODE,
    COLOR_GROUP_ID,
    COLOR_GROUP_CODE,
    SOLD_FLAG,
    PREV_STATUS_ID,
    PREV_STATUS_CODE,
    PREV_STATUS_SEASON_YEAR_ID,
    PREV_STATUS_SEASON_YEAR_CODE,
    PREV_STATUS_EVENT_ID,
    PREV_STATUS_EVENT_CODE,
    CURR_STATUS_ID,
    CURR_STATUS_CODE,
    CURR_STATUS_SEASON_YEAR_ID,
    CURR_STATUS_SEASON_YEAR_CODE,
    CURR_STATUS_EVENT_ID,
    CURR_STATUS_EVENT_CODE,
    NEXT_STATUS_ID,
    NEXT_STATUS_CODE,
    NEXT_STATUS_SEASON_YEAR_ID,
    NEXT_STATUS_SEASON_YEAR_CODE,
    NEXT_STATUS_EVENT_ID,
    NEXT_STATUS_EVENT_CODE,
    OPERATION_FLAG,
    INSERT_DATE,
    UPDATE_DATE,
    __DELETE_FLAG,
    __DUMMY_FLAG,
    __DQ_FLAG,
    DATE_PARTITION,
    LDTS,
    SOURCE_FILE,
    RECORD_SOURCE,
    PRODUCT_KEY,
    LOAD_DATE,
    PRODUCT_HK,
    PRODUCT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );

